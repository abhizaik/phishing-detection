#############################################
# MEMORY & EVICTION
#############################################

maxmemory 512mb
maxmemory-policy allkeys-lru


#############################################
# APPEND-ONLY FILE (AOF) PERSISTENCE
#############################################

appendonly yes
appendfilename "appendonly.aof"

# Fsync every second â€” production safe
appendfsync everysec

# Rewrite AOF automatically when it grows too large
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb


#############################################
# SNAPSHOTS (RDB)
#############################################

# Save if at least X writes happened within Y seconds
save 900 1
save 300 10
save 60 10000

# Keep RDB enabled for backup + safety
dbfilename dump.rdb
dir /data


#############################################
# NETWORKING
#############################################

bind 0.0.0.0
port 6379


#############################################
# SECURITY / PERFORMANCE
#############################################

# Disable RDB on shutdown only if AOF exists
rdbcompression yes
rdbchecksum yes

activerehashing yes

# Recommended for containerized environments
protected-mode no
